"use strict";const e=require("electron"),p=require("os"),s=require("path");process.env.DIST_ELECTRON=s.join(__dirname,"..");process.env.DIST=s.join(process.env.DIST_ELECTRON,"../dist");process.env.PUBLIC=e.app.isPackaged?process.env.DIST:s.join(process.env.DIST_ELECTRON,"../public");e.app.disableHardwareAcceleration();p.release().startsWith("6.1")&&e.app.disableHardwareAcceleration();process.platform==="win32"&&e.app.setAppUserModelId(e.app.getName());e.app.requestSingleInstanceLock()||(e.app.quit(),process.exit(0));let n=null;const a=s.join(__dirname,"../preload/index.js"),r=process.env.VITE_DEV_SERVER_URL,c=s.join(process.env.DIST,"index.html");async function l(){n=new e.BrowserWindow({width:880,height:640,minWidth:880,minHeight:640,transparent:!0,titleBarStyle:"hidden",backgroundColor:"rgba(60,55,59,0.45)",title:"",icon:s.join(process.env.PUBLIC,"favicon.ico"),webPreferences:{preload:a,nodeIntegration:!0,contextIsolation:!1}}),process.env.VITE_DEV_SERVER_URL?(n.loadURL(r),n.webContents.openDevTools()):n.loadFile(c),n.webContents.on("did-finish-load",()=>{n==null||n.webContents.send("main-process-message",new Date().toLocaleString())}),n.webContents.setWindowOpenHandler(({url:o})=>(o.startsWith("https:")&&e.shell.openExternal(o),{action:"deny"}))}e.app.whenReady().then(l);e.app.on("window-all-closed",()=>{n=null,process.platform!=="darwin"&&e.app.quit()});e.app.on("second-instance",()=>{n&&(n.isMinimized()&&n.restore(),n.focus())});e.app.on("activate",()=>{const o=e.BrowserWindow.getAllWindows();o.length?o[0].focus():l()});e.ipcMain.handle("open-win",(o,t)=>{const i=new e.BrowserWindow({webPreferences:{preload:a,nodeIntegration:!0,contextIsolation:!1}});process.env.VITE_DEV_SERVER_URL?i.loadURL(`${r}#${t}`):i.loadFile(c,{hash:t})});
